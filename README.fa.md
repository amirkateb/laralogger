# ูุงุฑุงูุงฺฏุฑ (Laralogger)

**Laralogger** ฺฉ ูพฺฉุฌ ูุฏุฑุชููุฏ ุจุฑุง ูุงฺฏโฺฏุฑ ุฎุทุง ุฏุฑ ูุงุฑุงูู ุงุณุช ฺฉู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุฎุทุงูุง HTTP ุณุฑ ดฐฐ ู ตฐฐ ุฑุง ุซุจุช ูโฺฉูุฏุ ููุชูฺฉุดูโูุง ููุดููุฏ ุจู ุชูฺฏุฑุงู ู ุงูู ูโูุฑุณุชุฏุ ุฎุทุงูุง ุณุณุชู ูุงููุฏ Nginx ุฑุง ุจุฑุฑุณ ูโฺฉูุฏุ ู ุฏุฑ ุตูุฑุช ูุงุฒุ ุขูโูุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ GPT ุชุญูู ูโฺฉูุฏ.

๐ [Read this in English](README.md)

---

## ๐ ุงูฺฉุงูุงุช

- โ ุซุจุช ุฏูู ุฎุทุงูุง ดxx ู ตxx ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ
- โ ุฐุฎุฑู ูุงฺฏโูุง ุฏุฑ ุฏุชุงุจุณ (ูู ูุงู)
- โ ููุชูฺฉุดู ุชูฺฏุฑุงูุ ุงูู ุง ุณูุงุฑุด
- โ ุชุญูู ููุด ูุตููุน (GPT-4/3.5)
- โ ุงุฌุฑุง ููู ููุงุฑุฏ ุงุฒ ุทุฑู ุตู (Queue)
- โ ุจุฑุฑุณ ูุงฺฏโูุง ุณุณุชู ูุซู `nginx error.log`
- โ ุฏุณุชูุฑุงุช artisan ุจุฑุง ุชุณุชุ ูพุงฺฉุณุงุฒุ ุงุณฺฉู ู ุฎุฑูุฌ
- โ ุจุฏูู ุฑุงุจุท ฺฏุฑุงูฺฉ ุจุฑุง ุงููุช ู ฺฉุงุฑุง ุจุดุชุฑ

---

## ๐ฆ ูุตุจ

```bash
composer require amirkateb/laralogger
php artisan vendor:publish --tag=laralogger-config
php artisan migrate
```

---

## โ๏ธ ูพฺฉุฑุจูุฏ

ูุงู `config/laralogger.php` ุดุงูู ููุงุฑุฏ ุฒุฑ ุงุณุช:

- ูุนุงู/ุบุฑูุนุงู ุจูุฏู
- ูุญุทโูุง ูุฌุงุฒ ุจุฑุง ุงุฌุฑุง (`production`, `staging`, ...)
- ฺฉุฏูุง HTTP ฺฉู ุจุงุฏ ุฐุฎุฑู ุง ููุชู ุดููุฏ
- ุชูุธูุงุช ููุชูฺฉุดู ู ุตู
- ฺฉูุฏ ู ูพุฑุงููพุช GPT ุจุฑุง ุชุญูู ููุดููุฏ
- ูุณุฑ ูุงู ูุงฺฏ nginx ู ุงูฺฏู ุชุดุฎุต (ูุซูุงู ุฎุทุง 502)

---

### ๐ฃ ุณุณุชู ููุชูฺฉุดู

ูุงุฑุงูุงฺฏุฑ ูุงุจูุช ุงุฑุณุงู ููุชูฺฉุดู ุฎุทุง ุงุฒ ุทุฑู ฺฉุงูุงูโูุง ูุฎุชูู ูุงููุฏ ุชูฺฏุฑุงูุ ุงูู ุง ฺฉูุงุณโูุง ุณูุงุฑุด ุฑุง ุฏุงุฑุฏ. ููุชูฺฉุดูโูุง ุจูุงูุงุตูู ูพุณ ุงุฒ ุซุจุช ูุฑ ุฎุทุง ูุนุงู ูโุดููุฏ.

#### ๐ง ุชูุธูุงุช

ุฏุฑ ูุงู `config/laralogger.php` ุจุฎุด ุฒุฑ ุฑุง ูพฺฉุฑุจูุฏ ฺฉูุฏ:

```php
'notification' => [
    'enabled' => true,
    'channels' => ['telegram', 'email'], // ุง ['custom']
    'queue' => true,
    'queue_name' => 'notifications',

    // ุงุฎุชุงุฑ: ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ ููุชูฺฉุดู ุณูุงุฑุด
    'custom_notifier' => \App\Notifications\CustomErrorNotifier::class,
],
```

#### ๐งฉ ููุชูุงุฑูุง ุฏุงุฎู

- `Laralogger\Notifications\TelegramNotifier`
- `Laralogger\Notifications\EmailNotifier`

ูโุชูุงูุฏ ฺฉูุงุณ ุฏูุฎูุงู ุฎูุฏุชุงู ุฑุง ุจุณุงุฒุฏ ฺฉู ุงุฒ ุงูุชุฑูุณ `Laralogger\Contracts\NotifiableInterface` ูพุฑู ฺฉูุฏ ู ุขู ุฑุง ุฏุฑ ุชูุธูุงุช ูุงุฑุฏ ฺฉูุฏ.

#### ๐งช ูุซุงู ุงุณุชูุงุฏู

```php
use Laralogger\Models\ErrorLog;
use Laralogger\Services\NotificationManager;

$log = ErrorLog::latest()->first();
NotificationManager::notify($log);
```

ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏูุ ููู ููุชูฺฉุดูโูุง ูโุชูุงููุฏ ุงุฒ ุทุฑู ุตู ุงุฑุณุงู ุดููุฏ.

---

 ### ๐ค ุชุญูู ุฎุทุง ุจุง ฺฉูฺฉ ููุด ูุตููุน (AI)

ูุงุฑุงูุงฺฏุฑ ุจูโุตูุฑุช ุงุฎุชุงุฑ ุงูฺฉุงู ุชุญูู ุฎุทุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ููุด ูุตููุน (ูุซู GPT-4 ุง GPT-3.5) ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุฏุฑ ุตูุฑุช ูุนุงูโุณุงุฒุ ุฎูุงุตูโุง ุงุฒ ุงุทูุงุนุงุช ุฎุทุง ุจุฑุง ูุฏู ุงูุชุฎุงุจโุดุฏู ุงุฑุณุงู ูโุดูุฏ ู ูพุงุณุฎ ุชุญูู (ุดุงูู ุนูุช ุงุญุชูุงู ู ุฑุงูโุญู ูพุดููุงุฏ) ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูโฺฏุฑุฏุฏ.

#### ๐ง ูุนุงูโุณุงุฒ ุชุญูู ุจุง ููุด ูุตููุน

ูุงู `config/laralogger.php` ุฑุง ูุฑุงุด ฺฉุฑุฏู ู ุจุฎุด `ai` ุฑุง ุจูโุตูุฑุช ุฒุฑ ุชูุธู ฺฉูุฏ:

```php
'ai' => [
    'enabled' => true,
    'provider' => 'openai',
    'api_key' => env('LARALOGGER_AI_API_KEY'),
    'model' => 'gpt-4', // ุง 'gpt-3.5-turbo'
    'prompt' => "You are an expert Laravel backend developer. Given this error, explain the root cause and suggest a fix:\n\n{{error}}",
    'queue' => true, // ุงุฌุฑุง ุงุฒ ุทุฑู ุตู
    'queue_name' => 'ai-analysis',
],
```

ุณูพุณ ููุฏุงุฑ ุฒุฑ ุฑุง ุฏุฑ `.env` ุชูุธู ฺฉูุฏ:

```
LARALOGGER_AI_API_KEY=sk-xxxxxx
```

> โ๏ธ ุฏุฑ ุฑุดุชูโ `prompt` ูโุชูุงูุฏ ุงุฒ `{{error}}` ุจุฑุง ูุฑุงุฑ ุฏุงุฏู ูุญุชูุง ุฎุทุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ.

#### ๐ฆ ุฎุฑูุฌ

- ูพุงุณุฎ ุชููุฏุดุฏู ุชูุณุท ููุด ูุตููุน ุฏุฑ ููุฏ `ai_analysis` ุฌุฏูู `error_logs` ุฐุฎุฑู ูโุดูุฏ.
- ุงฺฏุฑ ุตู ูุนุงู ุจุงุดุฏุ ุงู ูุฑุขูุฏ ุจูโุตูุฑุช ุบุฑููโุฒูุงู (async) ุงูุฌุงู ุฎูุงูุฏ ุดุฏ.
- ูโุชูุงูุฏ ูุชู prompt ุฑุง ุจุฑุง ูุญู ุง ฺฉุงุฑุจุฑุฏ ุฎุงุต ุฎูุฏุชุงู ุณูุงุฑุดโุณุงุฒ ฺฉูุฏ.

#### ๐งช ูุซุงู ุชุณุช

ุจุฑุง ุชุณุช:

```bash
php artisan laralog:test --code=500
```

ุณูพุณ ุฑฺฉูุฑุฏ ูุงฺฏ ุงุฌุงุฏโุดุฏู ุฏุฑ ุฏุชุงุจุณ ุฑุง ุจุฑุฑุณ ฺฉูุฏ โ ูพุงุณุฎ ุชุญูู ููุด ูุตููุน ุจุงุฏ ุจู ุขู ุงุถุงูู ุดุฏู ุจุงุดุฏ.

---

## ๐งช ุฏุณุชูุฑุงุช Artisan

```bash
php artisan laralog:test --code=500         # ุดุจูโุณุงุฒ ุฎุทุง
php artisan laralog:cleanup --days=30       # ุญุฐู ูุงฺฏโูุง ูุฏู
php artisan laralog:scan-nginx-log          # ุจุฑุฑุณ ูุงฺฏโูุง nginx
```

---

### ๐๏ธ ุณุงุฎุชุงุฑ ุฐุฎุฑูโุณุงุฒ ูุงฺฏโูุง

ูุงุฑุงูุงฺฏุฑ ุชูุงู ุฎุทุงูุง ุฑุง ุฏุฑ ุฌุฏูู `error_logs` ุฏุชุงุจุณ ุฐุฎุฑู ูโฺฉูุฏ. ูุฑ ุฑฺฉูุฑุฏ ุดุงูู ุฌุฒุฆุงุช ฺฉุงูู ุงุฒ ุฎุทุงุ ุฏุฑุฎูุงุณุชุ ฺฉุงุฑุจุฑุ ูุญุท ุงุฌุฑุง ู ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏูุ ุชุญูู AI ูโุจุงุดุฏ.

#### ๐ ููุง ฺฉู ุงุณฺฉูุง ุฌุฏูู

ุจูโุตูุฑุช ูพุดโูุฑุถุ ุณุชููโูุง ุฒุฑ ุฏุฑ ุฌุฏูู `error_logs` ุงุฌุงุฏ ูโุดููุฏ:

| ุณุชูู               | ุชูุถุญ                                              |
|--------------------|----------------------------------------------------|
| `id`               | ุดูุงุณู ุงุตู ุฑฺฉูุฑุฏ                                   |
| `message`          | ูพุงู ุฎุทุง ุฏุฑุงูุชโุดุฏู                              |
| `status_code`      | ฺฉุฏ ูุถุนุช HTTP (ูุซูุงู 500 ุง 404)                  |
| `exception_class`  | ูุงู ฺฉูุงุณ ุฎุทุง (Exception)                          |
| `file`             | ูุงู ุฑุฎุฏุงุฏ ุฎุทุง                                    |
| `line`             | ุดูุงุฑู ุฎุท                                           |
| `url`              | ุขุฏุฑุณ ุฏุฑุฎูุงุณุชโุดุฏู                                  |
| `method`           | ูุชุฏ HTTP (ูุซูุงู GET, POST)                        |
| `user_id`          | ุดูุงุณู ฺฉุงุฑุจุฑ (ุฏุฑ ุตูุฑุช ูุฑูุฏ)                        |
| `user_type`        | ููุน ูุฏู ฺฉุงุฑุจุฑ (ูุซูุงู App\Models\User)            |
| `headers`          | ูุฏุฑูุง ฺฉุงูู ุฏุฑุฎูุงุณุช (ูุฑูุช JSON)                  |
| `payload`          | ูุญุชูุง ุจุฏูู ุฏุฑุฎูุงุณุช (ูุฑูุช JSON)                  |
| `ip`               | ุขุฏุฑุณ IP ฺฉุงุฑุจุฑ                                     |
| `user_agent`       | ุงุทูุงุนุงุช ูุฑูุฑฺฏุฑ ุง ุฏุณุชฺฏุงู ฺฉุงุฑุจุฑ                    |
| `ai_analysis`      | ุชุญูู ููุด ูุตููุน (ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู)             |
| `created_at`       | ุฒูุงู ุซุจุช ุฎุทุง                                       |

#### ๐ ุณุงุฎุช ุฌุฏูู

ุจุฑุง ุณุงุฎุช ุฌุฏููุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

```bash
php artisan vendor:publish --tag=laralogger-migrations
php artisan migrate
```

ุฏุฑ ุตูุฑุช ูุงุฒ ูโุชูุงูุฏ ูุงฺฏุฑุดู ุฑุง ุดุฎุตโุณุงุฒ ฺฉุฑุฏู ู ุณุชููโูุง ุจุดุชุฑ ุงุถุงูู ฺฉูุฏ.

---

## ๐งพ ุณุงุฎุชุงุฑ ูุงฺฏ

ูุฑ ุฑฺฉูุฑุฏ ูุงฺฏ ุดุงูู ููุงุฑุฏ ุฒุฑ ุงุณุช:

- ฺฉุฏ ูุถุนุช (ดxxุ ตxx)
- ูพุงู ู ฺฉูุงุณ Exception
- URLุ methodุ IPุ header ู payload (ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู)
- ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ูุงฺฏูโุดุฏู (IDุ ูุงูุ ฺฏุงุฑุฏ)
- ูุชุฌู ุชุญูู AI (ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู)

---

### ๐ ุงุณฺฉู ุฒูุฏู ูุงฺฏโูุง Nginx

ูุงุฑุงูุงฺฏุฑ ูโุชูุงูุฏ ุจูโุตูุฑุช ุงุฎุชุงุฑุ ูุงู ูุงฺฏ ุฎุทุงูุง Nginx ุฑุง ูุงูุชูุฑ ฺฉูุฏ ุชุง ูุดฺฉูุงุช ุณุทุญ ุณุฑูุฑ ูุงููุฏ 502 Bad Gateway ุง 504 Timeout ุฑุง ุณุฑุนุงู ุดูุงุณุง ู ุซุจุช ฺฉูุฏุ ุญุช ูุจู ุงุฒ ุฑุณุฏู ุฏุฑุฎูุงุณุช ุจู Laravel.

#### ๐ง ุชูุธูุงุช

ุฏุฑ ูุงู `config/laralogger.php` ุจุฎุด ุฒุฑ ุฑุง ูพฺฉุฑุจูุฏ ฺฉูุฏ:

```php
'nginx_monitoring' => [
    'enabled' => true,
    'log_path' => '/var/log/nginx/error.log',
    'patterns' => [
        '502 Bad Gateway',
        '504 Gateway Timeout',
    ],
    'interval' => 10, // ูุฑ ฺูุฏ ุซุงูู ฺฉโุจุงุฑ ุจุฑุฑุณ ุดูุฏ
],
```

#### โ๏ธ ูุญูู ุนููฺฉุฑุฏ

- ฺฉ ูพุฑุฏุงุฒุด ูพุณโุฒููู (ูุซูุงู ุงุฒ ุทุฑู cronjob ุง systemd) ูุงู ูุงฺฏ Nginx ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ.
- ุงฺฏุฑ ฺฉ ุงุฒ ุงูฺฏููุง ุฎุทุง (ูุซูุงู 502) ุฏุฑ ูุงฺฏ ุฏุฏู ุดูุฏุ ฺฉ ุฎุทุง ุฌุฏุฏ ุซุจุช ู ููุฑุงู ููุชูฺฉุดู ุงุฑุณุงู ูโุดูุฏ.

#### ๐งช ุงุฌุฑุง ุฏุณุช

```bash
php artisan laralog:watch-nginx
```

ุจุฑุง ุงุฌุฑุง ูุฏุงูู ูโุชูุงูุฏ ุงุฒ `cron` ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
* * * * * php /path/to/artisan laralog:watch-nginx >> /dev/null 2>&1
```

ููฺูู ูโุชูุงูุฏ ูุณุฑูุง ูุชุนุฏุฏ ุฑุง ุจุฑุง ูุงูุชูุฑูฺฏ ุชูุธู ฺฉูุฏ.

---

### ๐ ุซุจุช ุฏุฑุฎูุงุณุชโูุง ูููู ู ุฑุฏุงุฑฺฉุช

ูุงุฑุงูุงฺฏุฑ ูุงุจูุช ุซุจุช ุฏุฑุฎูุงุณุชโูุง ุบุฑุฎุทุง ุฑุง ูุฒ ุฏุงุฑุฏุ ูุซู:

- ูพุงุณุฎโูุง ูููู (ฒxx)
- ุฑุฏุงุฑฺฉุชโูุง (ณxx)
- ูุณุฑูุง ุฎุงุต ูุซู callbackูุง ูพุฑุฏุงุฎุช ุง webhookูุง

ุงู ุงูฺฉุงู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ูุณุฑูุง ุญุงุช ุฑุง ุฑุฏุงุจ ู ุชุญูู ฺฉูุฏ.

#### ๐ง ุชูุธูุงุช

```php
'request_monitoring' => [
    'enabled' => true,
    'log_success' => true,
    'log_redirects' => true,
    'only_routes' => [ // ุงฺฏุฑ ุฎุงู ุจุงุดุฏุ ููู ูุงฺฏ ูโุดููุฏ
        'payment.callback',
        'webhook.telegram',
    ],
    'exclude_methods' => ['OPTIONS'],
],
```

#### ๐๏ธ ูุญู ุฐุฎุฑู ูุงฺฏโูุง

ุงู ูุงฺฏโูุง ูุฒ ุฏุฑ ุฌุฏูู `error_logs` ุฐุฎุฑู ูโุดููุฏุ ุงูุง ุฏุงุฑุง ฺฉุฏ ูุถุนุช `200` ุง `302` ู ุจุฏูู exception ูุณุชูุฏ. ุณุณุชู ุจูโุตูุฑุช ุฏุงุฎู ุขูโูุง ุฑุง ุงุฒ ุฎุทุงูุง ูุชูุงุฒ ูโฺฉูุฏ.

#### ๐ ููุงุฑุฏ ุงุณุชูุงุฏู

- **ุฏุจุงฺฏ ูพุฑุฏุงุฎุช**: ุจุฑุฑุณ ุฌุฒุฆุงุช ุฑูุชโูุขูุฏ ุจู ุฏุฑฺฏุงูโูุง ุจุงูฺฉ
- **ุฑุฏุงุจ ูุจููฺฉโูุง**: ุซุจุช ุฏูู ุฒูุงู ู ูุญุชูุง ูุฑูุฏ
- **ุชุญูู ุชุฑุงูฺฉ**: ุดูุงุณุง ูุณุฑูุง ูพุฑุชุฑุฏุฏ ุง ุฏุงุฑุง ุฑุฏุงุฑฺฉุช ุฒุงุฏ

---

## ๐ ูุฌูุฒ

MIT ยฉ 2025 [ุงูุฑูุญูุฏ ฺฉุงุชุจ ุตุงุจุฑ](mailto:amveks43@gmail.com)